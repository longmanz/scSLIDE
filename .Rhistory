refdata = list(celltype = "celltype"), reference.reduction = "pca", reduction.model = "umap")
p1 <- DimPlot(pancreas.ref, reduction = "umap", group.by = "celltype", label = TRUE, label.size = 3,
repel = TRUE) + NoLegend() + ggtitle("Reference annotations")
p2 <- DimPlot(pancreas.query, reduction = "ref.umap", group.by = "predicted.celltype", label = TRUE,
label.size = 3, repel = TRUE) + NoLegend() + ggtitle("Query transferred labels")
p1 + p2
dev.off()
rm(list=ls())
gc()
?PrepareSampleObject
devtools::load_all("~/Documents/github_repo/seurat-private/")
?PrepareSampleObject
?PrepareSampleObject
devtools::load_all("~/Documents/github_repo/seurat-private/")
?PrepareSampleObject
so = pbmc_small
SCTransform(object=so, ncells=100)
do.call(SCTransform, list(object=so, ncells=100))
so = pbmc3k
do.call(SCTransform, list(object=so, ncells=100))
so = UpdateSeuratObject(so)
do.call(SCTransform, list(object=so, ncells=100))
?RunAzimuth
do.call(SCTransform, list(object=so, ncells=100))
so = pbmc3k
dim(R2(pls.results)$val)
library(pls)
?plsr
data(yarn)
## Default methods:
yarn.pcr <- pcr(density ~ NIR, 6, data = yarn, validation = "CV")
yarn.pls <- plsr(density ~ NIR, 6, data = yarn, validation = "CV")
yarn.cppls <- cppls(density ~ NIR, 6, data = yarn, validation = "CV")
pls.results = yarn.pls
dim(R2(pls.results)$val)
R2(pls.results)$val
R2(pls.results)
mean_final_R2=1
message("The mean R2 of the PLS model is ", mean_final_R2)
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc_small
pbmc_small$Y = sample(c(500, 600, 700), size = ncol(pbmc_small), replace = T)
test = SketchDataByGroup(pbmc_small, group.by = "Y" , ncells = 5)
library(SeuratData)
object = pbmc3k
object = UpdateSeuratObject(object)
object = NormalizeData(object)
object = FindVariableFeatures(object, nfeatures = 1000)
object$Group = sample(c("A", "B"), size = ncol(object), replace = T)
object = ScaleData(object, features = VariableFeatures(object))
object = RunPLS(object, assay = "RNA", features = VariableFeatures(object), ncomp = 10, Y = "Group")
devtools::load_all("~/Documents/github_repo/seurat-private")
devtools::load_all("~/Documents/github_repo/seurat-private")
object = RunPLS(object, assay = "RNA", features = VariableFeatures(object), ncomp = 10, Y = "Group")
rm(list=ls())
mvrValstats
?
?mvrValstats
R2
devtools::load_all("/Users/uqljian5/Documents/github_repo/seurat-private/")
object = LoadData(pbmc3k)
object = pbmc3k
object$Y = sample(c("A", "B", "C"), size = ncol(object), replace = T)
object = UpdateSeuratObject(object)
object$Y = sample(c("A", "B", "C"), size = ncol(object), replace = T)
object = NormalizeData(object)
object = FindVariableFeatures(object, nfeatures = 200)
object = ScaleData(object)
object = RunPLS(object,Y = "Y")
devtools::load_all("/Users/uqljian5/Documents/github_repo/seurat-private/")
object = RunPLS(object,Y = "Y")
devtools::load_all("/Users/uqljian5/Documents/github_repo/seurat-private/")
object = RunPLS(object,Y = "Y")
devtools::load_all("/Users/uqljian5/Documents/github_repo/seurat-private/")
library(SeuratData)
object = pbmc3k
object = UpdateSeuratObject(object)
object$Y = sample(c("A", "B", "C"), size = ncol(object), replace = T)
object = NormalizeData(object)
object = FindVariableFeatures(object, nfeatures = 200)
object = ScaleData(object)
object = RunPLS(object,Y = "Y")
library(roxygen2)
roxygenise("/Users/uqljian5/Documents/github_repo/seurat-private/")
library(pls)
?plsr
devtools::load_all("~/Documents/github_repo/seurat-private/")
library(Seurat)
library(SeuratData)
object = UpdateSeuratObject(pbmc3k)
object = NormalizeData(object)
object = FindVariableFeatures(object, nfeatures = 500)
object = ScaleData(object)
head(object)
object = RunPLS(object, ncomp = 5, Y = "seurat_annotations")
object = RunPLS(object, ncomp = 5, Y = "nFeature_RNA")
object$seurat_annotations = factor(object$seurat_annotations)
object = RunPLS(object, ncomp = 5, Y = "seurat_annotations")
sum(object$seurat_annotations == 0)
sum(is.na(object$seurat_annotations))
object$seurat_annotations[is.na(object$seurat_annotations)] = "blank"
object = UpdateSeuratObject(pbmc3k)
object$seurat_annotations[is.na(object$seurat_annotations)] = "blank"
object = UpdateSeuratObject(pbmc3k)
str(object@meta.data)
object@meta.data[is.na(object$seurat_annotations), ]
table(object$seurat_annotations, useNA = "ifany")
object$test = sample(c("A", "C", "B"), size = ncol(object), replace = T)
object = NormalizeData(object)
object = FindVariableFeatures(object, nfeatures = 500)
object = ScaleData(object)
object = RunPLS(object, ncomp = 5, Y = "test")
object$test = factor(object$test)
object = RunPLS(object, ncomp = 5, Y = "test")
object@reductions$pls@misc
library(destiny)
DiffusionMap()
DiffusionMap
do.call
?do.call
withr::with_libpaths(new = "~/Documents/Rpackage_testing", devtools::install_version("Seurat", "5.3.1", force = TRUE))
library(Seurat, lib = "~/Documents/Rpackage_testing")
sessionInfo()
library(ggplot2)
sessionInfo()
################
# ggplot2 v4.0.0
################
print(packageVersion("ggplot2")) # if it doesn't print '4.0.0'; run the install
devtools::install_version("ggplot2", "4.0.0", force = TRUE) # restart R session after
print(packageVersion("ggplot2")) # should print '4.0.0'
library(Seurat)
library(patchwork, lib = "~/Documents/Rpackage_testing")
library(Seurat, lib = "~/Documents/Rpackage_testing")
################
# ggplot2 v4.0.0
################
library(ggplot2)
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(patchwork, lib = "~/Documents/Rpackage_testing")
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
VlnPlot(pbmc_small, features = "nCount_RNA")
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
withr::with_libpaths(new = "~/Documents/Rpackage_testing",
devtools::install_version("ggplot2", "3.5.2", force = TRUE))
################
# ggplot2 v4.0.0
################
library(ggplot2, lib = "~/Documents/Rpackage_testing")
library(Seurat, lib = "~/Documents/Rpackage_testing")
################
# ggplot2 v4.0.0
################
library(ggplot2, lib = "~/Documents/Rpackage_testing")
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(patchwork, lib = "~/Documents/Rpackage_testing")
sessionInfo()
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
VlnPlot(pbmc_small, features = "nCount_RNA")
library(ggplot2)
sessionInfo()
################
# ggplot2 v4.0.0
################
library(ggplot2)
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(patchwork, lib = "~/Documents/Rpackage_testing")
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
dev.off()
dev.off()
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
VlnPlot(pbmc_small, features = "nCount_RNA")
################
# ggplot2 v4.0.0
################
library(ggplot2, lib = "~/Documents/Rpackage_testing")
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
################
# ggplot2 v4.0.0
################
library(ggplot2, lib = "~/Documents/Rpackage_testing")
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(patchwork, lib = "~/Documents/Rpackage_testing")
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
sessionInfo()
# load data
pbmc3k.final <- LoadData("pbmc3k", type = "pbmc3k.final")
pbmc3k.final$groups <- sample(c("group1", "group2"), size = ncol(pbmc3k.final), replace = TRUE)
features <- c("LYZ", "CCL5", "IL32", "PTPRCAP", "FCGR3A", "PF4")
# ridgeplot
RidgePlot(pbmc3k.final, features = features, ncol = 2)
# vlnplot
VlnPlot(pbmc3k.final, features = features)
VlnPlot(pbmc3k.final, features = "percent.mt", split.by = "groups")
# featureplot
FeaturePlot(pbmc3k.final, features = features)
FeaturePlot(pbmc3k.final, features = "MS4A1")
FeaturePlot(pbmc3k.final, features = "MS4A1", min.cutoff = 1, max.cutoff = 3)
FeaturePlot(pbmc3k.final, features = c("MS4A1", "PTPRCAP"), min.cutoff = "q10", max.cutoff = "q90")
FeaturePlot(pbmc3k.final, features = c("MS4A1", "CD79A"), blend = TRUE)
FeaturePlot(pbmc3k.final, features = c("MS4A1", "CD79A"), split.by = "groups")
# dotplot
DotPlot(pbmc3k.final, features = features) + RotatedAxis()
DotPlot(pbmc3k.final, features = features, split.by = "groups") + RotatedAxis()
# doheatmap
DoHeatmap(subset(pbmc3k.final, downsample = 100), features = features, size = 3)
DoHeatmap(pbmc3k.final, features = VariableFeatures(pbmc3k.final)[1:100], cells = 1:500, size = 4, angle = 90) + NoLegend()
# labeling dimplot
plot <- DimPlot(pbmc3k.final, reduction = "pca") + NoLegend()
LabelClusters(plot = plot, id = "ident")
################
# ggplot2 v4.0.0
################
library(ggplot2)
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(patchwork, lib = "~/Documents/Rpackage_testing")
# pbmc_small examples (from user-raised issues)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
# ridgeplot
RidgePlot(pbmc3k.final, features = features, ncol = 2)
# vlnplot
VlnPlot(pbmc3k.final, features = features)
# vlnplot
VlnPlot(pbmc3k.final, features = features)
VlnPlot(pbmc3k.final, features = "percent.mt", split.by = "groups")
# featureplot
FeaturePlot(pbmc3k.final, features = features)
FeaturePlot(pbmc3k.final, features = "MS4A1")
FeaturePlot(pbmc3k.final, features = "MS4A1", min.cutoff = 1, max.cutoff = 3)
FeaturePlot(pbmc3k.final, features = c("MS4A1", "PTPRCAP"), min.cutoff = "q10", max.cutoff = "q90")
withr::with_libpaths(new = "~/Documents/Rpackage_testing/", devtools::install_github("git@github.com:longmanz/scSLIDE.git"))
withr::with_libpaths(new = "~/Documents/Rpackage_testing/", devtools::install_github("git@github.com:longmanz/scSLIDE.git", dependencies = T))
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("git@github.com:longmanz/scSLIDE.git", dependencies = T))
BiocManager::install(c("edgeR", "destiny"), lib = "~/Documents/Rpackage_testing/")
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("git@github.com:longmanz/scSLIDE.git"))
, dependencies = T
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("git@github.com:longmanz/scSLIDE.git", dependencies = T))
install.packages("glmGamPoi", lib = "~/Documents/Rpackage_testing/")
BiocManager::install(c("edgeR", "destiny", "glmGamPoi"), lib = "~/Documents/Rpackage_testing/")
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("git@github.com:longmanz/scSLIDE.git", dependencies = T))
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = T))
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = F))
library(c("edgeR", "destiny", "glmGamPoi"))
library(c("edgeR"))
library("edgeR")
library("destiny")
library("glmGamPoi")
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = F))
BiocManager::install(c("edgeR", "destiny", "glmGamPoi"), lib = "~/Documents/Rpackage_testing/")
BiocManager::install(c("edgeR", "destiny", "glmGamPoi"), lib = "~/Documents/Rpackage_testing/", force = T)
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = F))
BiocManager::install(c("edgeR", "destiny", "glmGamPoi", "limma"), lib = "~/Documents/Rpackage_testing/", force = T)
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = F))
BiocManager::install(c("edgeR", "destiny", "glmGamPoi", "limma"), lib = "~/Documents/Rpackage_testing/", force = T, depend = T)
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = F))
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = T))
filterByExpr
devtools::document("~/Documents/github_repo/scSLIDE")
devtools::document("~/Documents/github_repo/scSLIDE")
devtools::document("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
devtools::document("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
withr::with_libpaths(new = "~/Documents/Rpackage_testing/",
devtools::install_github("longmanz/scSLIDE", dependencies = T))
devtools::install_github("longmanz/scSLIDE", dependencies = T)
library(Seurat)
library(scSLIDE)
library(Seurat)
library(scSLIDE)
library(Seurat, lib = "~/Documents/Rpackage_testing/")
library(Seurat)
# print(packageVersion("Seurat") == "5.3.1") # should print TRUE
library(SeuratData)
library(ggplot2)
library(patchwork)
sessionInfo()
# load data
pbmc3k.final <- LoadData("pbmc3k", type = "pbmc3k.final")
p
pbmc3k.final = UpdateSeuratObject(pbmc3k.final)
pbmc3k.final$groups <- sample(c("group1", "group2"), size = ncol(pbmc3k.final), replace = TRUE)
features <- c("LYZ", "CCL5", "IL32", "PTPRCAP", "FCGR3A", "PF4")
# ridgeplot
RidgePlot(pbmc3k.final, features = features, ncol = 2)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
VlnPlot(pbmc_small, features = "nCount_RNA")
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
library(Seurat, lib = "~/Documents/Rpackage_testing")
library(SeuratData)
library(ggplot2)
library(patchwork)
sessionInfo()
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
dev.off()
dev.off()
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
VlnPlot(pbmc_small, features = "nCount_RNA")
pbmc3k.final <- LoadData("pbmc3k", type = "pbmc3k.final")
pbmc3k.final <- UpdateSeuratObject(pbmc3k.final)
pbmc3k.final$groups <- sample(c("group1", "group2"), size = ncol(pbmc3k.final), replace = TRUE)
features <- c("LYZ", "CCL5", "IL32", "PTPRCAP", "FCGR3A", "PF4")
# ridgeplot
RidgePlot(pbmc3k.final, features = features, ncol = 2)
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
VlnPlot(pbmc3k.final, features = features)
pbmc_small
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
FeaturePlot(pbmc3k.final, features = features)
DimPlot(pbmc_small, label.box = T, pt.size = 0.25, label.size = 5, label = T, cols = DiscretePalette(n = 3, palette = "polychrome"))
sessionInfo()
DimPlot(pbmc_small, reduction = "tsne", label = T, repel = T, label.box = T)
.Platform$OS.type
?FindmmNN
devtools::load_all("~/Documents/github_repo/scSLIDE")
?FindmmNN
warning("The number of knn.range is exceeding the number of available landmarks. Resetting it to length(landmarks)...")
warning("The number of knn.range is exceeding the number of available landmarks. Resetting it to length(landmarks) = ",
length(sketch_cells))
sketch_cells = 1:10
warning("The number of knn.range is exceeding the number of available landmarks. Resetting it to length(landmarks) = ",
length(sketch_cells))
original_plan <- future::plan()
original_plan
!inherits(original_plan, "sequential")
future::plan()
SketchDataByGroup
?SketchDataByGroup
library(roxygen2)
roxygenise("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
roxygenise("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
roxygenise("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
devtools::check("~/Documents/github_repo/scSLIDE")
]
library(devtools)
library(roxygen2)
devtools::load_all("~/Documents/github_repo/seurat-private")
library(SeuratData)
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc = LoadData("pbmc3k")
pbmc = UpdateSeuratObject(pbmc)
head(pbmc)
pbmc$type = sample(c("a", "b"), size = ncol(pbmc), replace = T)
pbmc = NormalizeData(pbmc)
pbmc = FindVariableFeatures(pbmc, nfeatures = 500)
pbmc = ScaleData(pbmc)
pbmc = RunPLS(pbmc, ncomp = 20, Y = "type", pls.function = "spls")
sessionInfo()
pbmc = RunPLS(pbmc, ncomp = 5, Y = "type", pls.function = "spls")
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc = RunPLS(pbmc, ncomp = 5, Y = "type", pls.function = "spls")
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc = RunPLS(pbmc, ncomp = 5, Y = "type", pls.function = "spls")
?CreateDimReducObject
CreateDimReducObject
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc = RunPLS(pbmc, ncomp = 5, Y = "type", pls.function = "spls")
devtools::load_all("~/Documents/github_repo/seurat-private")
pbmc = RunPLS(pbmc, ncomp = 5, Y = "type", pls.function = "spls")
pbmc[['RNA']]
pbmc['RNA']
pbmc@reductions$pls
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(devtools)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(Seurat)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(Seurat)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(devtools)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(desc)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(callr)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("glmGamPoi", "destiny"), lib = "~/Documents/test")
BiocManager::install(c("glmGamPoi", "destiny"), lib = "~/Documents/test", depend = T)
BiocManager::install(c("glmGamPoi", "destiny"), lib = "~/Documents/test", depend = T, force = T)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("BiocGenerics"), lib = "~/Documents/test", depend = T, force = T)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("SummarizedExperiment"), lib = "~/Documents/test", depend = T, force = T)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(Seurat)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(Seurat, lib = "~/Documents/test")
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(devtools)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(desc)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(callr)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("MatrixGenerics"))
library(MatrixGenerics)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("MatrixGenerics"), lib = "~/Documents/test", force = T)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(SeuratObject, lib = "~/Documents/test")
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
BiocManager::install(c("S4Vectors"), lib = "~/Documents/test", force = T)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE"))
library(devtools)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE", dependencies = F))
library(desc)
withr::with_libpaths(new = "~/Documents/test", code = devtools::install_github("longmanz/scSLIDE", dependencies = F))
devtools::install_github("longmanz/scSLIDE", dependencies = F, lib = "~/Documents/test")
library(scSLIDE)
library(scSLIDE, lib = "~/Documents/test")
library(SeuratObject)
devtools::load_all("/Users/uqljian5/Documents/github_repo/seurat")
library(scSLIDE, lib = "~/Documents/test")
object <- readRDS("/Users/uqljian5/Documents/github_repo/scSLIDE/vignettes/Raw_count_Subset_104k_Ahern_2022_Cell.rds")
object <- NormalizeData(object)
head(object)
object <- CloudAzimuth(object)
library(AzimuthAPI)
object <- CloudAzimuth(object)
object <- CloudAzimuth(object)
# Get the top 2000 highly variable genes
object <- FindVariableFeatures(object, nfeatures = 2000)
object
object <- PrepareSampleObject(object = object,
assay = "RNA",
add.hvg = T,
group.by.CorTest = "azimuth_label",
Y = "Disease",
sketch.training = T,
group.by.Sketch = "Donor",
ncells.per.group = 1000,
ncells.landmark = 2000,
ncomp = 20,
pls.function = "cppls",
k.nn = 5,
name.reduction.1 = "azimuth_embed",
dims.reduction.1 = 1:128,
fix.wnn.weights = c(0.5, 0.5),
verbose = T)
plan()
?PrepareSampleObject
PrepareSampleObject
#
options(future.globals.maxSize = 5 * 1000 * 1024^2)
object <- PrepareSampleObject(object = object,
assay = "RNA",
add.hvg = T,
group.by.CorTest = "azimuth_label",
Y = "Disease",
sketch.training = T,
group.by.Sketch = "Donor",
ncells.per.group = 1000,
ncells.landmark = 2000,
ncomp = 20,
pls.function = "cppls",
k.nn = 5,
name.reduction.1 = "azimuth_embed",
dims.reduction.1 = 1:128,
fix.wnn.weights = c(0.5, 0.5),
verbose = T)
sample_obj = GenerateSampleObject(object = object,
sketch.assay = "LANDMARK",
nn.name = "weighted.nn",
group.by = "Donor",
rename.group.by = "azimuth_label",
k.nn = 5,
normalization.method = "ChiSquared",
add.meta.data = TRUE,
return.seurat = T)
# Center the data
sample_obj = ScaleData(sample_obj, features = rownames(sample_obj), do.scale = F, do.center = T)
sample_obj = RunDiffusionMap(sample_obj, assay = "LMC", layer = "scale.data", features = rownames(sample_obj), ncomp = 10)
DimPlot(sample_obj, reduction = "DiffMap", group.by = "Disease") +
DimPlot(sample_obj, reduction = "DiffMap", group.by = "Disease", dims = c(1, 3))
dev.off()
setwd("~/Documents/github_repo/scSLIDE")
pkgdown::build_site()
q()
